<% provide(:title, custom_title('Cinemas')) %>
<div class="container">
<h1>Cinemas</h1>
<% if admin? %>
  <%= link_to 'New Cinema', new_cinema_path, class: 'btn btn-primary' %>
  <table class="table table-hover">
    <thead>
      <tr>
        <th>Name</th>
        <th>Created At</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <% @cinemas.each do |cinema| %>
      <tr>
        <td>
          <%= cinema.name %>
          <% if cinema.movies.count > 0 %>
            <p><%= link_to "Movies | #{cinema.movies.count}", cinema_movies_path(cinema) %></p>
          <% end %>
          <% if cinema.bookings.count > 0 %>
            <p><%= link_to "Bookings | #{cinema.bookings.count}", cinema_books_path(cinema) %></p>
          <% end %>
          <p>Availability: <%= cinema.availability %></p>
        </td>
        <td><%= cinema.created_at.to_formatted_s(:short) %></td>
        <td>
          <%= link_to 'View', cinema_path(cinema), class: 'btn btn-success' %>
          <%= link_to 'Edit', edit_cinema_path(cinema), class: 'btn btn-warning' %>
          <%= link_to 'Delete', cinema_path(cinema), method: :delete, data: { confirm: "Are you sure you want to delete this cinema?" }, class: "btn btn-danger" %>
          <%= link_to 'Add Movie', new_cinema_movie_path(cinema), class: 'btn btn-primary' %>
        </td>
      </tr>
      <% end %>
    <tbody>
  </table>
<% else %>
  <% @cinemas.each_slice(3) do |cinemas_slice| %>
    <div class="row">
        <% cinemas_slice.each do |cinema| %>
        <div class="col-md-4">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title"><%= cinema.name %></h5>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>
<% end %>
<%= paginate @cinemas %>